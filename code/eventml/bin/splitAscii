#!/bin/bash

num=0

file=$1

dir=$2

mkdir -p ${dir}

echo "splitting file ${file} into the directory ${dir}"

old_IFS=$IFS
IFS=$'\n'
for line in $(cat ${file})
do
    #echo "${line}"
    if [[ "${line}" =~ ^\{.* ]]
    then
	num=`expr ${num} + 1`
	echo "  block: ${num}"
	> "${dir}/${file}-${num}"
    fi
    echo "${line}" >> "${dir}/${file}-${num}"
done
IFS=$old_IFS